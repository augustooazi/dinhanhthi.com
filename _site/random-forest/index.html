<!DOCTYPE html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="default-src 'self';object-src 'none';script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com/;style-src 'self' https://fonts.googleapis.com/ https://use.fontawesome.com/ 'unsafe-inline';img-src 'self' data:;font-src 'self' https://fonts.gstatic.com/ https://use.fontawesome.com/" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Random Forest</title><meta content="Random Forest" property=og:title><meta content="What's the idea of Random Forest? # Random forest consists a (large) number of decision trees operating together (ensemble learning). The..." name=description><meta content="What's the idea of Random Forest? # Random forest consists a (large) number of decision trees operating together (ensemble learning). The..." property=og:description><meta content=summary_large_image name=twitter:card><meta content=@dinhanhthi name=twitter:site><meta content=@dinhanhthi name=twitter:creator><meta content=/img/header/decision-tree.svg property=og:image><link href=https://dinhanhthi.com/random-forest/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="üî• Anh-Thi DINH"><link href=/ rel=preconnect crossorigin=""><script src="/js/min.js?hash=70bdd86fac" async defer></script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))
      document
        .documentElement
        .classList
        .add('apple')</script><style>@charset "UTF-8";@font-face{font-display:swap;font-family:"Poppins";font-style:normal;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-regular.eot);src:local("Poppins Regular"),local("Poppins-Regular"),url(/fonts/poppins/poppins-v15-latin-regular.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-regular.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-regular.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-regular.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-regular.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:"Poppins";font-style:italic;font-weight:400;src:url(/fonts/poppins/poppins-v15-latin-italic.eot);src:local("Poppins Italic"),local("Poppins-Italic"),url(/fonts/poppins/poppins-v15-latin-italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:normal;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600.eot);src:local("Poppins SemiBold"),local("Poppins-SemiBold"),url(/fonts/poppins/poppins-v15-latin-600.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Poppins';font-style:italic;font-weight:600;src:url(/fonts/poppins/poppins-v15-latin-600italic.eot);src:local("Poppins SemiBold Italic"),local("Poppins-SemiBoldItalic"),url(/fonts/poppins/poppins-v15-latin-600italic.eot?#iefix) format("embedded-opentype"),url(/fonts/poppins/poppins-v15-latin-600italic.woff2) format("woff2"),url(/fonts/poppins/poppins-v15-latin-600italic.woff) format("woff"),url(/fonts/poppins/poppins-v15-latin-600italic.ttf) format("truetype"),url(/fonts/poppins/poppins-v15-latin-600italic.svg#Poppins) format("svg")}@font-face{font-display:swap;font-family:'Recoleta';src:url(/fonts/recoleta/Recoleta-Bold.woff2) format("woff2"),url(/fonts/recoleta/Recoleta-Bold.woff) format("woff"),url(/fonts/poppins/Recoleta-Bold.ttf) format("truetype");font-weight:700;font-style:bold}*{border:0;box-sizing:border-box}:root{font-size:16.5px}main img{content-visibility:auto}::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-thumb{background:#3e466b;border-radius:6px}::-webkit-scrollbar-thumb:hover{background:#aaa;cursor:pointer}::-webkit-scrollbar-track{background:#363948}::-webkit-scrollbar-corner{background:#282a36}body,html{font-family:"Poppins",Arial,Helvetica,sans-serif;font-size:16.5px}html{-webkit-text-size-adjust:100%}@supports (font-variation-settings:normal){html{font-family:"Poppins" var alt,Arial,Helvetica,sans-serif}}body{background:#282a36;color:#eee;margin:0;counter-reset:h2counter}strong{font-weight:600;color:#8cc8ff}sup{top:-.5em}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}a,a:hover{text-decoration:none}a:hover{border-bottom:2px solid #ffd479;color:#fff}a.no-effect:hover{border-bottom:none}img{max-width:100%}main{margin:0 auto}.page-note h3,.page-note>h2,h1,h2,h3{font-family:"Recoleta",Arial,Helvetica,sans-serif}h1{font-size:29.7px}h2{font-size:24.75px}h3{font-size:21.5325px}.page-note h3,.page-note>h2{color:#eee}.page-note h3:hover .direct-link,.page-note>h2:hover .direct-link{display:inline-block}.page-note h3:hover a:hover,.page-note>h2:hover a:hover,a{color:#ffd479}.page-note>h2{font-size:24.75px;margin:37.125px 0 19.8px}.page-note p+ol,.page-note p+ul,.page-note>h2+h3{margin-top:-.5rem}.page-note>h3{font-size:21.5325px;margin-bottom:19.8px}.page-note .direct-link{display:none;color:#777;border-bottom:none;margin-left:3px}.page-note pre+h2,.page-note pre+h3,.page-note>h3{margin-top:37.125px}.page-note h1{counter-reset:h2counter}.page-note h2{counter-reset:h3counter}.page-note h3{counter-reset:h4counter}.page-note h3:before{opacity:.5;content:counter(h2counter) "." counter(h3counter) ".¬†¬†";counter-increment:h3counter}.page-note h2:before{content:counter(h2counter) ".¬†¬†";counter-increment:h2counter;color:#8cc8ff}.container,header{width:100%;margin:0 auto}.normal{padding:0 16.5px;width:100%}@media (min-width:916.5px){.normal{width:900px}}.mt-2{margin-top:2rem}.page-index .container{padding:2rem 1rem 0}.page-index .main-cats{flex:0 1 calc(100% - 280px);padding-right:1rem}.page-index .main-cats>.category-wrapper{padding-bottom:1.5rem}.page-index .main-cats>.category-wrapper>.category{border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:2rem 1.5rem 1.5rem}.page-index .toc-index{border:1px solid #404040;border-radius:7px;height:fit-content;background:#35373c;flex:0 1 280px;position:sticky;top:60px;padding:1rem 1.1rem}.page-index .toc-index h3{padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 10px;font-size:1.3rem}.page-index .toc-index ul{padding-left:20px;margin:0}.page-index .toc-index p{font-style:italic;color:#999;padding-top:0;margin-bottom:0;font-size:.95rem;margin-top:10px}.page-index .toc-index p a{color:#999;border-bottom:2px solid #999}.page-index .toc-index p a:hover{border-bottom:2px solid #ffd479}@media (max-width:991px){.page-index .main-cats{flex:1 1 100%;order:2;padding-right:0}.page-index .toc-index{flex:1 1 100%;order:1;position:inherit;margin-bottom:1.5rem}.page-index .toc-index ul{column-count:3;-webkit-column-count:3;-moz-column-count:3}}@media (max-width:767px){.page-index .toc-index ul{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (max-width:575px){.page-index .toc-index ul{column-count:1;-webkit-column-count:1;-moz-column-count:1}}.category{width:100%}.category h2,header h1{font-size:1.55rem;margin-top:0}.category h2 img{float:left;margin-right:7px}.category .list-homepage{list-style:none;padding-left:10px;margin-bottom:0;column-count:1;-webkit-column-count:1;-moz-column-count:1}@media (min-width:768px){.category .list-homepage{column-count:2;-webkit-column-count:2;-moz-column-count:2}}@media (min-width:992px){.category .list-homepage{column-count:3;-webkit-column-count:3;-moz-column-count:3}}.category .list-homepage li{padding-left:15px;margin-bottom:10px;display:inline-block;width:100%}.category .list-homepage li a{color:#ddd;border-bottom:2px solid rgba(255,255,255,.14);border-style:dotted}.category .list-homepage li::before{content:"üìÑ";margin-right:5px;margin-left:-25px;opacity:.8}.category .list-homepage li:hover{cursor:pointer}.category .list-homepage li:hover a{border-color:#ffd479;color:#fff}.category .list-homepage li:hover::before{opacity:1}.page-index header{padding-top:4em}.page-index header .header-logo{height:80px;width:auto}header nav{z-index:10}#nav{z-index:2;position:relative}header{padding:5.5rem 1.5rem 1rem;width:900px;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header h1{font-size:2.2rem;margin-bottom:0}header p{margin-top:1rem}header .header-logo{width:55px;height:55px;margin-bottom:1rem}header .header-logo img{width:100%;height:100%}header .social{margin-top:.5rem}header #more-info #note-tag>a,header .social a{margin-right:10px}header .social a:last-child{margin-right:0}@media (min-width:992px){header .social a{margin-right:20px}}header .social a img{border-radius:50%}header #more-info{padding:1rem}header #more-info #note-tag{padding-bottom:10px;border-bottom:1px solid #444}header #more-info #note-tag>a::before{content:"#"}header #more-info #last-modified{padding-top:10px;font-style:italic}#reading-progress,nav{top:0;left:0;width:100vw}#reading-progress{z-index:3;border-bottom:1px solid #ffd479;position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}.intro,.job span{font-size:1.02rem}.intro b,.intro strong{color:#ffd479;font-weight:400}.intro a,footer a:hover{color:#fff}.job span{background:#ffd479;color:#000;padding:3px 10px;border-radius:15px}nav{position:fixed;padding:0 1.5em;background:#35373c}@media (max-width:992px){nav{padding:0 1em}}@media (max-width:576px){nav{padding:0 .5em}}nav #nav{display:-ms-flexbox;-ms-flex-align:center;align-items:center}nav #nav a{color:#ccc;margin-right:15px;align-items:center;padding:0 .5rem;font-size:1.1rem;white-space:nowrap}nav #nav a img{margin-right:5px}nav #nav a:hover{color:#fff;cursor:pointer;text-decoration:none}nav #nav .nav-item{text-align:left;margin-right:5px}@media (min-width:421px){nav #nav .nav-item{padding-left:0!important}}@media (max-width:575px){nav #nav .nav-item{width:unset!important}nav #nav .nav-item span{display:none}}@media (min-width:576px){nav #nav .nav-item{margin-right:15px}}nav #nav .nav-github{text-align:right;padding-right:0!important;margin-right:0!important}nav #nav .nav-search{display:block;background-image:linear-gradient(to right,#3d4251,#3b3f4c,#393d46,#373a41,#35373c);width:100%;position:relative}nav #nav,nav #nav .nav-search form,nav #nav a{display:flex}nav #nav .nav-search .nav-search-input{border:0;background:0 0;color:#ddd;font-size:1.05rem;padding:.65rem .5rem;width:100%}nav #nav .nav-search .nav-search-input:focus{outline:0;border:0}nav #nav .nav-search #search-result{position:absolute;max-height:80vh;overflow:auto;width:100%;background:#35373c;border-bottom-right-radius:5px;border-bottom-left-radius:5px;padding:0 1rem}@media (max-width:767px){nav #nav .nav-search #search-result{position:fixed;left:0;right:0;border-radius:0}}nav #nav .nav-search #search-result ul#searchResults{padding:0 0 0 20px}.page-note ol li,.page-note ul li,div.toc ol li,nav #nav .nav-search #search-result ul#searchResults li h3{margin-bottom:5px}nav #nav .nav-search #search-result ul#searchResults li h3 a{color:#efb232;white-space:inherit;padding:0;text-align:left;font-weight:400;font-size:16.5px;font-family:"Poppins",Arial,Helvetica,sans-serif;line-height:1.4}nav #nav .nav-search #search-result ul#searchResults li h3 a:hover{border-bottom:none;color:#8cc8ff}nav #nav .nav-search #search-result ul#searchResults li p{text-align:left;margin-top:0;line-height:1.4}nav #nav .nav-search #search-result #noResultsFound p{text-align:left}footer{font-size:1.1rem;background:#35373c;padding:.75rem 1rem;text-align:center;margin-top:3rem}footer a{color:#ccc}.success{position:relative;padding:16.5px;margin-bottom:24.75px;border:1px solid transparent;border-radius:.25rem;color:#eee;border-left-width:15px;border-color:#86f7a2}.success :last-child{margin-bottom:0}.columns-2{display:grid;grid-template-columns:1fr 1fr;align-items:center;margin-bottom:24.75px}@media (min-width:576px) and (max-width:767px){.columns-2{grid-template-columns:2fr 1fr}}@media (max-width:575px){.columns-2{grid-template-columns:1fr}}@media (min-width:576px){.columns-2>:nth-child(1){padding-right:5px;margin-bottom:0}.columns-2>:nth-child(1)>:last-child,.columns-2>:nth-child(2)>:last-child{margin-bottom:0}.columns-2>:nth-child(2){padding-left:5px;margin-bottom:0}}.hsbox{margin-bottom:24.75px;border:1px solid #969696;padding:1rem;border-radius:3px}.hsbox .hs__title{cursor:pointer}.hsbox .hs__title::before{content:" ";display:inline-block;border-top:7px solid transparent;border-bottom:7px solid transparent;border-left:7px solid currentColor;vertical-align:middle;margin-right:.7rem;transform:translateY(-2px);transition:transform .2s ease-out}.hsbox .hs__title.show{padding-bottom:15px;border-bottom:.5px solid #666;margin-bottom:1rem}.hsbox .hs__title.show+.hs__content{display:block;opacity:1;padding:5px 0;transition:all .25s 0s cubic-bezier(.4,0,.2,1)}.hsbox .hs__title.show::before{transform:rotate(90deg) translateX(-3px)}.hsbox .hs__content{display:none;transition:all .2s 0s ease}.hsbox .hs__content>:last-child{margin-bottom:0}.page-note .text-center{text-align:center}.page-note ol,.page-note p,.page-note ul{margin-top:0;margin-bottom:24.75px}.page-note ol li ol,.page-note ol li ul,.page-note ul li ol,.page-note ul li ul{margin-bottom:5px;padding-left:20px}.page-note ol li>*,.page-note ul li>*{margin-bottom:10px}.page-note p.noindent{display:none;padding-left:20px}.page-note p.noindent+ol,.page-note p.noindent+ul{padding-left:20px}.page-note p.indent{display:none;padding-left:40px}.page-note ol.indent,.page-note p.indent+ol,.page-note p.indent+ul,.page-note ul.indent{padding-left:40px}.page-note ol.noindent,.page-note ul.noindent{padding-left:20px}.page-note hr{border-bottom:1px solid #676767;margin-bottom:24.75px}#reading-list .item .author{font-style:italic}#reading-list .item .intro{color:#999}code[class*=language-],pre[class*=language-]{color:#eee;font-size:16px;text-shadow:none;font-family:Menlo,Monaco,Consolas,"Andale Mono","Ubuntu Mono","Courier New",monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#75a7ca}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}.token.comment{color:#6a9955}.token.punctuation{color:#eee}.token.inserted,.token.number{color:#b5cea8}.token.builtin,.token.string{color:#ce9178}.token.operator{color:#eee}.token.important,.token.keyword{color:#90cdff}.token.property{color:#9cdcfe}.token.selector{color:#d7ba7d}pre[class*=language-]>code[class*=language-]{position:relative;z-index:1}code,pre{font-family:Consolas,Menlo,Monaco,"Andale Mono WT","Andale Mono","Lucida Console","Lucida Sans Typewriter","DejaVu Sans Mono","Bitstream Vera Sans Mono","Liberation Mono","Nimbus Mono L","Courier New",Courier,monospace;line-height:1.5}h2>code{font-size:21.78px!important}h3>code{font-size:18.9486px!important}:not(pre)>code{border:1px solid #444;background:#6b444245;padding:2px 4px;margin:0 1px;border-radius:3px;font-size:.9rem;color:#fff;word-break:break-word}h2>code,h3>code{color:#ddd;padding-right:6px}a>code{color:#ffd479}a:hover>code{color:#ccc}pre,pre[class*=language-]{margin:0 0 27.225px;overflow:auto}pre>code,pre[class*=language-]>code{display:block;padding:14.5px 16.5px 16.5px;background:#2f3240;border:.5px solid #3b3e54;overflow:auto;border-radius:3px;max-height:450px}div.toc{margin-bottom:24.75px;border:1px solid #3b3e54;border-radius:7px;height:fit-content;background:#2f3240;padding:15px 15px 10px 0}div.toc>ol::before{content:"In this note";display:block;padding-bottom:5px;border-bottom:1px solid #555;margin:0 0 15px;font-size:1.18rem;font-family:"Recoleta",Arial,Helvetica,sans-serif}div.toc ol{padding-left:20px;font-size:14.85px;margin-bottom:0}div.toc ol li code{font-size:.85rem;background:#ececec;padding:0 4px 2px}div.toc ol li ol{padding-left:10px;margin-top:7px}div.toc ol,div.toc ol ol{counter-reset:item;list-style-type:none}div.toc ol li::before{content:counters(item,".") ". ";counter-increment:item}div.toc>ol>li ol>li::before{opacity:.7}div.toc>ol>li::before{color:#8cc8ff}@media (min-width:1300px){div.toc{float:right;margin-right:-280px;border-left:none;width:250px;position:-webkit-sticky;position:sticky;top:60px;max-height:70vh;overflow:auto}div.toc ol{margin-top:0;margin-bottom:0}}@media (min-width:1500px){div.toc{margin-right:-310px;width:280px}}.toc-active>a{color:#fff!important}.toc-active::before{opacity:1!important}.page-note img{height:auto;width:100%}.page-note img.bg-white{background:#fff}@media (min-width:768px){.page-note .img-100,.page-note .img-full-85{width:85%;margin-left:auto;margin-right:auto;display:block}.page-note .img-100{width:100%}}.page-note p>img+br{display:none}.page-note p>img+br+em{display:block;text-align:center;margin-top:10px}</style><header><nav><div id=nav><a href=/ class="nav-item no-effect"><img alt=home src=/img/nav/home.svg height=18 width=18> <span>Thi</span> </a><a href=/about/ class="nav-item no-effect"><img alt=about src=/img/nav/about.svg height=15 width=15> <span>About</span></a><div class=nav-search><form><input aria-label="search notes..." class=nav-search-input id=searchField placeholder="search notes..." type=search></form><div id=search-result style="display: none;"><ul id=searchResults></ul><div id=noResultsFound style="display: none;"><p>No results found.</div></div></div><a href=https://github.com/dinhanhthi class="nav-item no-effect nav-github" target=_blank><img alt=github src=/img/nav/github.svg height=20 width=20></a></div><div id=reading-progress aria-hidden=true></div></nav><div class=header-logo><img alt="Random Forest" src=/img/header/decision-tree.svg></div><h1>Random Forest</h1><div id=more-info><div id=note-tag><a href=/tags/machine-learning>Machine Learning</a></div><div id=last-modified>30-11-2020</div></div></header><main><article><div class="container mt-2 normal page-note"><div class=toc><ol><li><a href="#what's-the-idea-of-random-forest%3F">What's the idea of Random Forest?</a><li><a href=#when-we-use-random-forest%3F>When we use Random Forest?</a><li><a href=#using-rf-with-scikit-learn>Using RF with Scikit-learn</a><ol><li><a href=#random-forest-classifier>Random forest classifier</a><li><a href=#random-forest-regression>Random forest regression</a><li><a href=#select-important-features-in-random-forest>Select important features in Random Forest</a></ol><li><a href=#references>References</a></ol></div><h2 id="what's-the-idea-of-random-forest%3F">What's the idea of Random Forest? <a href="#what's-the-idea-of-random-forest%3F" class=direct-link>#</a></h2><p>Random forest consists a (large) number of <a href="/search?q=decision+tree">decision trees</a> operating together (<a href=https://en.wikipedia.org/wiki/Ensemble_learning>ensemble learning</a>). The class with the most votes from the trees will be chosen as the final result of the RF's prediction. These decision tree models are relatively uncorrelated so that they can protect each other from their individual errors.<p><img alt="An illustration of the random forest's idea." src=/img/post/ML/random-forest-decision-tree/rf1.jpg class=img-full-85><br><em>An illustration of the random forest's idea.</em><div class=hsbox><div class=hs__title>What is <strong>Ensemble Learning</strong>?</div><div class=hs__content><p>Ensemble learning involves the <strong>combination of several models</strong> to solve a single prediction problem. It works by generating multiple classifiers/models which learn and make predictions independently. Those predictions are then combined into a single (mega) prediction that should be as good or better than the prediction made by any one classifer.<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup></div></div><p>‚ùì <strong>How (decision) trees are chosen?</strong> RF ensures that the chosen trees are not too correlated to the others.<ol><li><strong>Bagging</strong>: From a sample of size N, trees are chosen so that they also have size N <strong>with replacement</strong>. For example, if our training data was [1, 2, 3, 4, 5] (size 5), then we might give one of our tree the list [1, 2, 2, 5, 5] (with replacement).<li><strong>Feature randomness</strong>: The features in the original dataset are chosen randomly. There may be some trees that are lacking in some features.</ol><p>So in our random forest, we end up with trees that are not only trained on different sets of data (thanks to bagging) but also use different features to make decisions<sup><a href=https://towardsdatascience.com/understanding-random-forest-58381e0602d2 target=_blank rel="noopener noreferrer">[ref]</a></sup>.<p><em>For each tree</em>, we can use <a href=/decision-tree-classifier>decision tree classifier</a> or <a href=/decision-tree-regression>decision tree regression</a> depending on the type our problem (classification or regression).<h2 id=when-we-use-random-forest%3F>When we use Random Forest? <a href=#when-we-use-random-forest%3F class=direct-link>#</a></h2><ul><li><a href="/search?q=decision+tree">Decision tree algorithms</a> easily lead to <a href=/underfitting-overfitting>overfitting problems</a>. Random forest algorithm can overcome this.<li>Capable of both regression and classification problems.<li>Handle a large number of features.<li>Estimating which features are important in the underlying data being modeled<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup>.<li>Random forest is capable of learning without carefully crafted data transformations<sup><a href=http://blog.yhat.com/posts/random-forests-in-python.html target=_blank rel="noopener noreferrer">[ref]</a></sup>.<li>Output probabilities for classification problems.</ul><h2 id=using-rf-with-scikit-learn>Using RF with Scikit-learn <a href=#using-rf-with-scikit-learn class=direct-link>#</a></h2><h3 id=random-forest-classifier>Random forest classifier <a href=#random-forest-classifier class=direct-link>#</a></h3><p>Load the library,<pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier</code></pre><p>A sample dataset:<pre class=language-python><code class=language-python>iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># iris flowers</span><br>X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<br>y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target</code></pre><p>Create RF classifier(<a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>other parameters</a>),<pre class=language-python><code class=language-python>clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'entropy'</span><span class="token punctuation">,</span> <span class="token comment"># default is 'gini'</span><br>                             n_estimators<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment"># number of trees (default=10)</span><br>                             n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># number of processors being used ("-1" means "all")</span></code></pre><div class=success><p>If a problem has <strong>imbalanced classes</strong>, use <code>class_weight="balanced"</code>.<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/handle_imbalanced_classes_in_random_forests/ >[ref]</a></sup></div><p>Training & predict (<a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>other methods</a>),<pre class=language-python><code class=language-python>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># returns: array([1])</span><br>model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># predict class probabilities</span></code></pre><h3 id=random-forest-regression>Random forest regression <a href=#random-forest-regression class=direct-link>#</a></h3><pre class=language-python><code class=language-python><span class="token comment"># load libraries</span><br><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor<br><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets</code></pre><pre class=language-python><code class=language-python><span class="token comment"># sample: Boston Housing Data</span><br>boston <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span><br>X <span class="token operator">=</span> boston<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><br>y <span class="token operator">=</span> boston<span class="token punctuation">.</span>target</code></pre><pre class=language-python><code class=language-python><span class="token comment"># train</span><br>regr <span class="token operator">=</span> RandomForestRegressor<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><br>model <span class="token operator">=</span> regr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><pre class=language-python><code class=language-python><span class="token comment"># predict</span><br>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token operator">&lt;</span>something<span class="token operator">></span><span class="token punctuation">)</span></code></pre><h3 id=select-important-features-in-random-forest>Select important features in Random Forest <a href=#select-important-features-in-random-forest class=direct-link>#</a></h3><p>Some premilinaries,<pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier<br><br><span class="token comment"># Load data</span><br>iris <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span><br>X <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<br>y <span class="token operator">=</span> iris<span class="token punctuation">.</span>target<br><br><span class="token comment"># create a RF classifier</span><br>clf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre><p>Select feature importance<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/feature_importance target=_blank rel="noopener noreferrer">[ref]</a></sup>,<pre class=language-python><code class=language-python><span class="token comment"># Train model</span><br>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br><br><span class="token comment"># Calculate feature importances</span><br>importances <span class="token operator">=</span> model<span class="token punctuation">.</span>feature_importances_<br><br><span class="token comment"># load additional packages</span><br><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<br><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</code></pre><p>Visualize,<div class=columns-2><pre class=language-python><code class=language-python><span class="token comment"># Sort feature importances in descending order</span><br>indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>importances<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><br><span class="token comment"># Rearrange feature names so they match the sorted feature importances</span><br>names <span class="token operator">=</span> <span class="token punctuation">[</span>iris<span class="token punctuation">.</span>feature_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><br><br>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Feature Importance"</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> importances<span class="token punctuation">[</span>indices<span class="token punctuation">]</span><span class="token punctuation">)</span><br>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> names<span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span><br><br>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img alt="Features importances." src=/img/post/ML/random-forest-decision-tree/feature_importance_11_0.png class="bg-white img-100"></div><p>Select features with importance greater than a threshold,<sup><a href=https://chrisalbon.com/machine_learning/trees_and_forests/select_important_features_in_random_forest target=_blank rel="noopener noreferrer">[ref]</a></sup><pre class=language-python><code class=language-python><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectFromModel<br><br><span class="token comment"># Create object that selects features with importance greater than or equal to a threshold</span><br>selector <span class="token operator">=</span> SelectFromModel<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><br><br><span class="token comment"># Feature new feature matrix using selector</span><br>X_important <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><br><br><span class="token comment"># Train random forest using most important features</span><br>model <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_important<span class="token punctuation">,</span> y<span class="token punctuation">)</span></code></pre><h2 id=references>References <a href=#references class=direct-link>#</a></h2><ul><li><strong>Tony Yiu</strong> -- <a href=https://towardsdatascience.com/understanding-random-forest-58381e0602d2>Understanding Random Forest</a>.<li><strong>Scikit-learn</strong> -- <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html>Random Forest CLassifier</a> official doc.<li><strong>Scikit-learn</strong> -- <a href=https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html>Random Forest Regression</a> official doc.<li><strong>Chris Albon</strong> -- <a href=https://chrisalbon.com/machine_learning/trees_and_forests/titanic_competition_with_random_forest/ >Titanic Competition With Random Forest</a>.<li><strong>The Yhat Blog</strong> -- <a href=http://blog.yhat.com/posts/random-forests-in-python.html>Random Forests in Python</a>.<li><strong><a href=http://fast.ai>fast.ai</a></strong> -- <a href=http://course18.fast.ai/lessonsml1/lesson1.html>Introduction to Random Forest</a> and a solution to "<em>Bull Book for Bulldozers</em>" problem on Kaggle.</ul></div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Random Forest",
        "image": [],
        "author": "Anh-Thi DINH",
        "genre": "Insert a schema.org genre",
        "url": "https://dinhanhthi.com/random-forest/",
        "mainEntityOfPage": "https://dinhanhthi.com/random-forest/",
        "datePublished": "02-09-2019",
        "dateModified": "30-11-2020",
        "description": "What&#39;s the idea of Random Forest? # Random forest consists a (large) number of decision trees operating together (ensemble learning). The..."
      }</script></article></main><footer><a href=/ target=_blank>Thi ¬†¬©¬† 2020 </a>¬†‚Ä¢¬† <a href=/about-the-notes/ >About the notes </a>¬†‚Ä¢¬† <a href=https://pobo.dinhanhthi.com target=_blank>Po Bo </a>¬†‚Ä¢¬† <a href=/for-me-only/ >For me only </a>¬†‚Ä¢¬† <a href=/donate/ >Support Thi</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script>